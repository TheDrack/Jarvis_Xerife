name: Repo Lifecycle Governance

on:
  workflow_dispatch:

jobs:
  governance:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Repo Lifecycle Governance
        env:
          PIPELINE_STRICT: "false"
        run: |
          echo "========================================"
          echo " Repo Lifecycle Governance"
          echo "========================================"
          python scripts/repo_lifecycle_governance.py

      - name: Commit frozen changes (no PR, no merge)
        run: |
          if [[ -n "$(git status --porcelain)" ]]; then
            git config user.name "governance-bot"
            git config user.email "governance@bot"
            git add .
            git commit -m "chore: lifecycle governance (freeze/unfreeze)"
            git push
          else
            echo "No changes to commit"
          fi